<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>投资计算器</title>
<style>
body {
font-family: Arial, sans-serif;
margin: 20px;
display: flex;
flex-direction: column;
align-items: center;
}

h1 {
font-size: 2em;
text-align: center;
margin-bottom: 20px;
animation: colorChange 6s infinite, scalePulse 2s infinite ease-in-out;
}

@keyframes colorChange {
0% { color: #4CAF50; }
33% { color: #FF0000; }
66% { color: #1E90FF; }
100% { color: #4CAF50; }
}

@keyframes scalePulse {
0% { transform: scale(1); }
50% { transform: scale(1.05); }
100% { transform: scale(1); }
}

.container {
width: 100%;
max-width: 600px;
display: flex;
flex-direction: column;
align-items: stretch;
}

.input-group {
display: flex;
justify-content: space-between;
margin-bottom: 10px;
}

label {
display: block;
margin-bottom: 5px;
flex: 1;
}

input[type="number"] {
width: 100%;
padding: 8px;
margin-bottom: 10px;
border: 1px solid #ccc;
border-radius: 4px;
box-sizing: border-box;
}

button {
padding: 10px;
background-color: #4CAF50;
color: white;
border: none;
border-radius: 4px;
cursor: pointer;
width: 100%;
box-sizing: border-box;
}

button:hover {
background-color: #3e8e41;
}

.results-group {
display: flex;
justify-content: space-between;
width: 100%;
}

p {
flex: 1;
text-align: center;
}

.table-container {
overflow-x: auto; /* 启用水平滚动 */
overflow-y: auto;
max-height: 400px;
width: 100%;
}

table {
width: 100%;
border-collapse: collapse;
margin-top: 20px;
table-layout: auto; /* 自动分配列宽 */
}

th,
td {
border: 1px solid #ddd;
padding: 8px;
text-align: left;
}

th {
background-color: #f2f2f2;
position: sticky;
top: 0;
z-index: 1;
}

td:last-child,
th:last-child {
min-width: 80px; /* 为日期列设置最小宽度 */
white-space: nowrap; /* 防止日期列换行 */
}

.highlight {
background-color: yellow;
}
</style>
</head>
<body>
<h1>麻乙科技投种收益计算器</h1>
<div class="container">
<div class="input-group">
<label for="principal">
本金 (至少 100 美元):
<input type="number" id="principal" value="100" min="100">
</label>
<label for="expectedDailyReturn">
期望每天返利 (美元):
<input type="number" id="expectedDailyReturn" value="5">
</label>
</div>
<button onclick="calculate()">计算</button>
<div class="results-group">
<p>达到投入本金: <span id="daysToPrincipal"></span></p>
<p>达到期望每天返利: <span id="daysToExpectedReturn"></span></p>
<p>复投次数: <span id="reinvestCount"></span> 次</p>
</div>
<div class="table-container">
<table id="dataTable">
<thead>
<tr>
<th>天</th>
<th>返利</th>
<th>累计</th>
<th>累计2</th>
<th>复投</th>
<th>本金</th>
<th>日期</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
<script>
function calculate() {
    const principal = parseFloat(document.getElementById("principal").value);
    const expectedDailyReturn = parseFloat(document.getElementById("expectedDailyReturn").value);

    if (principal < 100) {
        alert("本金需100美元以上");
        return;
    }

    const {
        daysToReachPrincipal,
        daysToReachExpectedReturn,
        reinvestCount,
        returnsTable
    } = calculateReturns(principal, expectedDailyReturn);

    document.getElementById("daysToPrincipal").textContent = daysToReachPrincipal > 0 ? daysToReachPrincipal + " 天" : "未知";
    document.getElementById("daysToExpectedReturn").textContent = daysToReachExpectedReturn > 0 ? daysToReachExpectedReturn + " 天" : "未达到期望值";
    document.getElementById("reinvestCount").textContent = reinvestCount;

    populateTable(returnsTable);
}

function calculateReturns(principal, expectedDailyReturn) {
    let leveragedPrincipal = principal * 11;
    let cumulativeReturn = 0;
    let nonReinvestedReturn = 0;
    let days = 0;
    const returnsTable = [];
    const startDate = new Date();
    let reinvestCount = 0;
    let daysToReachExpectedReturn = -1;
    let daysToReachPrincipal = -1;
    const maxDays = 5000;

    while (days < maxDays) {
        days++;
        const currentDate = new Date(startDate);
        currentDate.setDate(startDate.getDate() + days - 1);
        const dailyReturn = leveragedPrincipal * 0.0005;

        nonReinvestedReturn += dailyReturn;

        if (nonReinvestedReturn >= principal && daysToReachPrincipal === -1) {
            daysToReachPrincipal = days;
        }

        if (dailyReturn >= expectedDailyReturn && daysToReachExpectedReturn === -1) {
            daysToReachExpectedReturn = days;
        }

        cumulativeReturn += dailyReturn;
        leveragedPrincipal -= dailyReturn;

        let reinvestAmount = 0;
        if (cumulativeReturn >= 100) {
            reinvestAmount = cumulativeReturn;
            leveragedPrincipal += (cumulativeReturn * 11);
            cumulativeReturn = 0;
            reinvestCount++;
        }

        returnsTable.push({
            day: days,
            dailyReturn: dailyReturn.toFixed(2),
            cumulativeReturn: cumulativeReturn.toFixed(2),
            nonReinvestedReturn: nonReinvestedReturn.toFixed(2),
            reinvestAmount: reinvestAmount.toFixed(2),
            leveragedPrincipal: leveragedPrincipal.toFixed(2),
            date: currentDate.toLocaleDateString('zh-CN', {
                year: '2-digit',
                month: '2-digit',
                day: '2-digit'
            }).replace(/\//g, '-')
        });

        if (dailyReturn >= expectedDailyReturn && daysToReachPrincipal !== -1) {
            break;
        }
    }

    if (days >= maxDays && daysToReachExpectedReturn === -1) {
        daysToReachExpectedReturn = -1;
    }
    if (days >= maxDays && daysToReachPrincipal === -1) {
        daysToReachPrincipal = -1;
    }

    return {
        daysToReachPrincipal,
        daysToReachExpectedReturn,
        reinvestCount,
        returnsTable
    };
}

function populateTable(returnsTable) {
    const tableBody = document.getElementById("dataTable").querySelector("tbody");
    tableBody.innerHTML = "";

    returnsTable.forEach(data => {
        const row = tableBody.insertRow();
        row.insertCell().textContent = data.day;
        row.insertCell().textContent = data.dailyReturn;
        row.insertCell().textContent = data.cumulativeReturn;
        row.insertCell().textContent = data.nonReinvestedReturn;
        row.insertCell().textContent = data.reinvestAmount;
        row.insertCell().textContent = data.leveragedPrincipal;
        row.insertCell().textContent = data.date;

        if (parseFloat(data.reinvestAmount) > 0) {
            row.classList.add("highlight");
        }
    });
}
</script>
</body>

</html>
